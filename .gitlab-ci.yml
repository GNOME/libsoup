image: fedora:28

variables:
  ADDITIONAL_DEPENDENCIES: which gtk-doc libpsl-devel make httpd php php-xmlrpc mod_ssl redhat-rpm-config

build_stable:
  before_script:
    - dnf update -y --nogpgcheck
    - dnf install -y 'dnf-command(builddep)'
    - dnf builddep -y --nogpgcheck libsoup
    - dnf install -y --nogpgcheck $ADDITIONAL_DEPENDENCIES
  script:
    - ./autogen.sh
    - make
    - make check
  artifacts:
    paths: 
      - tests/test-suite.log
    when: on_failure
